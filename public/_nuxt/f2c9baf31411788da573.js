(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{614:function(e,r,t){"use strict";t.r(r);t(8),t(14);var n=t(62),o=t(65),c=t(66),m={name:"SignUpForm",components:{LoadingSpinner:o.a,Blocker:c.a},data:function(){return{username:this.$route.query.username||"",password:this.$route.query.password||"",password2:"",checkingName:!1,server_error:!1,registering:!1}},watch:{"$route.query":function(e,r){this.username=e.username,this.password=e.password,this.username&&this.$v.username.$touch(),this.password&&this.$v.password.$touch()}},mounted:function(){this.username&&this.$v.username.$touch(),this.password&&this.$v.password.$touch()},validations:function(){var e=this;return{username:{required:n.required,format:function(e){return/^[A-Za-z0-9]+$/.test(e)},maxLength:Object(n.maxLength)(9),unique:function(r,t){return""===r||!e.$v.username.format||!e.$v.username.maxLength||(t.checkingName=!0,e.checkUserNameDuplicate(r).then(function(r){return e.checkingName=!1,!r}))}},password:{required:n.required,digit:function(e){return/^[0-9]+$/.test(e)},len:function(e){return 4===e.length}},password2:{required:n.required,matched:function(e,r){return e===r.password}}}},methods:{handleSubmit:function(){var e=this;if(this.server_error=!1,this.registering=!0,this.username&&this.password){var r=this.username+"@gacha.simulator",t=this.password+"@gacha.simulator";this.$functions.httpsCallable("createUser")({username:this.username,password:t,email:r}).then(function(n){e.$auth.signInWithEmailAndPassword(r,t)}).then(function(){e.registering=!1,e.$router.replace("/signup/success"),e.$v.$reset(),e.password="",e.username=""}).catch(function(r){console.log(r),e.registering=!1,e.server_error=!0;var t=e.username;e.username="",e.username=t})}},checkUserNameDuplicate:function(e){return this.$auth.fetchSignInMethodsForEmail(e+"@gacha.simulator").then(function(data){return data.length>0}).catch(function(e){return console.log(e),!0})}}},l=t(7),d={name:"Index",components:{SignUpForm:Object(l.a)(m,function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.registering?[t("LoadingSpinner"),e._v(" "),t("Blocker")]:e._e(),e._v(" "),t("form",[e.server_error?t("p",{staticClass:"text-danger"},[e._v("\n      There is an error from the server. Please try again.\n    ")]):e._e(),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"inputUserName"}},[e._v("User name")]),e._v(" "),t("input",{staticClass:"form-control",attrs:{id:"inputUserName",type:"username","aria-describedby":"inputUserName",placeholder:"Enter user name"},domProps:{value:e.username},on:{change:function(r){e.username=r.target.value,e.$v.username.$touch()}}}),e._v(" "),e.$v.username.$dirty?[e.$v.username.format?e.$v.username.maxLength?e.checkingName||e.$v.username.$pending?t("small",[t("b-spinner",{staticStyle:{width:"1rem",height:"1rem"},attrs:{variant:"primary"}}),e._v("\n          checking\n        ")],1):e.$v.username.unique?e.$v.username.$dirty?t("small",{staticClass:"text-success"},[e._v("\n          This name is valid.\n        ")]):e._e():t("small",{staticClass:"text-danger"},[e._v("\n          The name has been taken.\n        ")]):t("small",{staticClass:"text-danger"},[e._v("\n          The maximum length is 9.\n        ")]):t("small",{staticClass:"text-danger"},[e._v("\n          The name should contain letters and digits only.\n        ")])]:e._e()],2),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"InputPassword"}},[e._v("PIN")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{id:"InputPassword",type:"password",placeholder:"Enter 4-digit PIN"},domProps:{value:e.password},on:{change:function(r){return e.$v.password.$touch()},input:function(r){r.target.composing||(e.password=r.target.value)}}}),e._v(" "),e.$v.password.$error?t("small",{staticClass:"error"},[e._v("\n        PIN should be a 4-digit number\n      ")]):e._e()]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"InputPassword2"}},[e._v("Confirm PIN")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password2,expression:"password2"}],staticClass:"form-control",attrs:{id:"InputPassword2",type:"password",placeholder:"Enter PIN again"},domProps:{value:e.password2},on:{change:function(r){return e.$v.password2.$touch()},input:function(r){r.target.composing||(e.password2=r.target.value)}}}),e._v(" "),e.$v.password2.$error?t("small",{staticClass:"error"},[e._v("\n        The PIN does not match with previous one.\n      ")]):e._e()]),e._v(" "),t("div",{staticClass:"d-flex  w-100"},[t("div",{staticClass:"m-auto"},[t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.$v.$invalid},on:{click:function(r){return r.preventDefault(),e.handleSubmit()}}},[e._v("\n          submit\n        ")])])])])],2)},[],!1,null,"4a2d8366",null).exports},methods:{}},h=Object(l.a)(d,function(){var e=this.$createElement,r=this._self._c||e;return r("div",[r("SignUpForm")],1)},[],!1,null,"cf325f2c",null);r.default=h.exports}}]);